# Epic 2: Enhanced Team Collaboration & Communication

**Objective:** Make the agents more communicative, structured, and efficient in their collaboration. This involves adding more agents, defining roles more strictly, and implementing proactive communication protocols.

---

### **Sprint Breakdown**

#### **Task 2.1: Configuration - Reconfigure Agent Team & Roles**

*   **Goal:** Restructure the agent team to better reflect a real-world software development team and enforce role-specific capabilities.
*   **Implementation Details:**
    1.  **Add Second Programmer (`database/init_db.py`):**
        *   In the `seed_initial_data` function, a second `Agent` record will be created with the `Programmer` role.
        *   This new agent will be named distinctively (e.g., `Paige_The_Programmer`) and will have a slightly different persona to introduce more varied technical discussions.
    2.  **Update Agent-Conversation Memberships (`database/init_db.py`):**
        *   The new programmer will be added to the member lists of relevant `Conversation` channels, such as `#general` and `#engineering`.
    3.  **Implement Role-Based Tool Access (`agents/agents.py`):**
        *   The current method of registering all tools for all agents will be refactored.
        *   In each `create_<role>_agent` function (e.g., `create_marketer_agent`), we will define an explicit list of tool names that the agent is allowed to use.
        *   For example, `create_marketer_agent` will *only* be given access to tools like `web_search`, `write_tweet`, and communication tools. It will be denied access to `create_code_file`.
        *   Conversely, `create_programmer_agent` will have access to all development tools but might have restricted access to marketing-specific tools.
*   **Acceptance Criteria:**
    *   The application starts with five agents, including two distinct programmers.
    *   The marketer agent is verifiably unable to execute a development tool like `create_code_file`.
    *   The programmer agents can successfully execute coding tasks.
    *   The new programmer participates in conversations in the `#engineering` channel.

---

#### **Task 2.2: Agent Logic - Proactive Status Reporting**

*   **Goal:** Empower agents to communicate their status autonomously, ensuring the team (and the CEO) stays informed without manual intervention.
*   **Implementation Details:**
    1.  **Modify `complete_task` Logic:**
        *   The logic for what happens after a task is completed will be moved from the `update_task_progress` function directly into the agent's decision loop.
        *   In `decide_next_action` (`agents/agent_manager.py`), after an agent decides a task is complete and calls `complete_task`, it will immediately trigger a follow-up action.
    2.  **Implement Reporting Hierarchy:**
        *   A new function, `get_superior(agent_role)`, will be created to define the reporting structure (e.g., Programmers report to the CEO).
        *   Upon completing a task, the agent will check `get_superior()` and automatically call the `send_direct_message` tool to inform their superior. The message will include the title of the completed task.
    3.  **Implement "Asking for Help":**
        *   A new status, `BLOCKED`, will be utilized more effectively.
        *   When an agent cannot proceed with a task (e.g., a required file is missing, or it needs information from another agent), it will update its task status to `BLOCKED`.
        *   This status change will trigger a communication action: the agent will `send_direct_message` to the most relevant colleague (determined by a new `get_helper_for_task` function) or post in a general help channel.
*   **Acceptance Criteria:**
    *   When a programmer completes a coding task, they automatically send a DM to the CEO stating, "Task 'Implement User Auth' is complete."
    *   When an agent's task is blocked, it proactively sends a message asking for help.
    *   These communications are visible in the client and are not hard-coded prompts, but are generated by the agents themselves based on their state.

---
### **Potential Challenges**

*   **Communication Spam:** Proactive reporting, if not implemented carefully, could lead to agents spamming channels or superiors with trivial updates. The trigger for reporting must be significant (e.g., top-level task completion).
*   **Determining the "Right" Helper:** The logic for `get_helper_for_task` will be heuristic-based and may not always select the perfect person. This will require iterative refinement.
*   **Deadlocks:** A scenario could arise where two agents are blocked and waiting for each other. The system will need a timeout or an escalation path to the CEO to resolve such deadlocks. 